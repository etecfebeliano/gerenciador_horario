import{r as v,j as e,M as V,a as s,u as F,R as ae,D as G,H as se,b as oe,c as te,F as ee,L as de}from"./index-2220a25f.js";import ce from"dompurify";import ie from"exceljs";import"firebase/compat/app";import"firebase/compat/auth";import"firebase/compat/firestore";import"zod";import"jspdf";const Q=({isOpen:r,onClose:i,onConfirm:g,title:m,message:u})=>{const l=v.useRef(null);return v.useEffect(()=>{r&&setTimeout(()=>{var d;(d=l.current)==null||d.focus()},50)},[r]),e(V,{isOpen:r,onClose:i,title:m,children:s("div",{className:"space-y-4",children:[e("p",{className:"text-sm text-gray-700",children:u}),s("div",{className:"mt-6 flex justify-end space-x-2",children:[e("button",{ref:l,type:"button",onClick:i,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancelar"}),e("button",{type:"button",onClick:()=>{g(),i()},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Confirmar Exclusão"})]})]})})},Y=r=>ce.sanitize(r),me=()=>{const{state:r,dispatch:i}=F(),[g,m]=v.useState(!1),[u,l]=v.useState(null),[o,d]=v.useState(""),[n,c]=v.useState({isOpen:!1,id:null}),b=y=>{l(y),d(y?y.nome:""),m(!0)},D=()=>{m(!1),l(null),d("")},N=y=>{if(y.preventDefault(),!o.trim())return;const C=Y(o);i(u?{type:"UPDATE_CURSO",payload:{...u,nome:C}}:{type:"ADD_CURSO",payload:{id:`c${Date.now()}`,nome:C}}),D()},x=y=>{c({isOpen:!0,id:y})},p=()=>{n.id&&i({type:"DELETE_CURSO",payload:{id:n.id}}),c({isOpen:!1,id:null})};return s("div",{children:[s("div",{className:"flex justify-between items-center mb-4",children:[e("h2",{className:"text-2xl font-bold",children:"Gerenciar Cursos"}),e("button",{onClick:()=>b(null),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Adicionar Curso"})]}),e("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:r.cursos.length>0?r.cursos.map(y=>s("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 flex flex-col justify-between hover:shadow-md transition-shadow",children:[e("span",{className:"font-medium text-gray-800 mb-4",children:y.nome}),s("div",{className:"flex justify-end space-x-2",children:[e("button",{onClick:()=>b(y),className:"p-2 text-gray-500 hover:text-indigo-600 rounded-full hover:bg-gray-100 transition-colors",title:"Editar",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L14.732 3.732z"})})}),e("button",{onClick:()=>x(y.id),className:"p-2 text-gray-500 hover:text-red-600 rounded-full hover:bg-gray-100 transition-colors",title:"Excluir",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},y.id)):e("div",{className:"col-span-full bg-white border border-gray-200 rounded-lg shadow-sm p-6 text-center text-gray-500",children:"Nenhum curso cadastrado."})}),e(V,{isOpen:g,onClose:D,title:u?"Editar Curso":"Adicionar Curso",children:s("form",{onSubmit:N,children:[e("label",{htmlFor:"cursoName",className:"block text-sm font-medium text-gray-700",children:"Nome do Curso"}),e("input",{type:"text",id:"cursoName",value:o,onChange:y=>d(y.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0}),s("div",{className:"mt-4 flex justify-end space-x-2",children:[e("button",{type:"button",onClick:D,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),e("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Salvar"})]})]})}),e(Q,{isOpen:n.isOpen,onClose:()=>c({isOpen:!1,id:null}),onConfirm:p,title:"Confirmar Exclusão de Curso",message:"Tem certeza que deseja excluir este curso? Todas as turmas, disciplinas e aulas associadas também serão removidas permanentemente."})]})},ue=()=>{const{state:r,dispatch:i}=F(),[g,m]=v.useState(!1),[u,l]=v.useState(null),[o,d]=v.useState({nome:"",cursoId:"",periodo:"manha",isModular:!1}),[n,c]=v.useState("all"),[b,D]=v.useState({isOpen:!1,id:null});v.useEffect(()=>{!o.cursoId&&r.cursos.length>0&&d(t=>({...t,cursoId:r.cursos[0].id}))},[r.cursos,o.cursoId]);const N=t=>{var h;l(t),d(t?{nome:t.nome,cursoId:t.cursoId,periodo:t.periodo,isModular:!!t.isModular}:{nome:"",cursoId:((h=r.cursos[0])==null?void 0:h.id)||"",periodo:"manha",isModular:!1}),m(!0)},x=()=>{m(!1),l(null),d({nome:"",cursoId:"",periodo:"manha",isModular:!1})},p=t=>{if(t.preventDefault(),!o.nome.trim()||!o.cursoId||!o.periodo)return;const h={...o,nome:Y(o.nome)};i(u?{type:"UPDATE_TURMA",payload:{...u,...h}}:{type:"ADD_TURMA",payload:{id:`t${Date.now()}`,...h}}),x()},y=t=>{D({isOpen:!0,id:t})},C=()=>{b.id&&i({type:"DELETE_TURMA",payload:{id:b.id}}),D({isOpen:!1,id:null})},T=t=>{var h;return((h=r.cursos.find(f=>f.id===t))==null?void 0:h.nome)||"N/A"},k=r.turmas.filter(t=>n==="all"?!0:t.cursoId===n);return s("div",{children:[s("div",{className:"flex justify-between items-center mb-4",children:[e("h2",{className:"text-2xl font-bold",children:"Gerenciar Turmas"}),s("div",{className:"flex items-center space-x-4",children:[s("div",{className:"w-64",children:[e("label",{htmlFor:"curso-filter",className:"block text-sm font-medium text-gray-700",children:"Filtrar por Curso"}),s("select",{id:"curso-filter",value:n,onChange:t=>c(t.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e("option",{value:"all",children:"Todos os Cursos"}),r.cursos.map(t=>e("option",{value:t.id,children:t.nome},t.id))]})]}),e("button",{onClick:()=>N(null),className:"self-end px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400",disabled:r.cursos.length===0,children:"Adicionar Turma"})]})]}),e("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:k.length>0?k.map(t=>s("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 flex flex-col justify-between hover:shadow-md transition-shadow",children:[s("div",{children:[s("div",{className:"flex justify-between items-start",children:[e("h4",{className:"font-bold text-gray-800",children:t.nome}),t.isModular&&e("span",{className:"flex-shrink-0 text-xs bg-purple-100 text-purple-800 font-semibold ml-2 px-2 py-0.5 rounded-full",children:"Modular"})]}),e("p",{className:"text-sm text-gray-500",children:T(t.cursoId)}),e("p",{className:"text-sm text-gray-500 capitalize",children:t.periodo})]}),s("div",{className:"flex justify-end space-x-2 mt-4",children:[e("button",{onClick:()=>N(t),className:"p-2 text-gray-500 hover:text-indigo-600 rounded-full hover:bg-gray-100 transition-colors",title:"Editar",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L14.732 3.732z"})})}),e("button",{onClick:()=>y(t.id),className:"p-2 text-gray-500 hover:text-red-600 rounded-full hover:bg-gray-100 transition-colors",title:"Excluir",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)):e("div",{className:"col-span-full bg-white border border-gray-200 rounded-lg shadow-sm p-6 text-center text-gray-500",children:r.turmas.length===0?"Nenhuma turma cadastrada.":"Nenhuma turma encontrada para o filtro selecionado."})}),e(V,{isOpen:g,onClose:x,title:u?"Editar Turma":"Adicionar Turma",children:s("form",{onSubmit:p,className:"space-y-4",children:[s("div",{children:[e("label",{htmlFor:"turmaName",className:"block text-sm font-medium text-gray-700",children:"Nome da Turma"}),e("input",{type:"text",id:"turmaName",value:o.nome,onChange:t=>d({...o,nome:t.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),s("div",{children:[e("label",{htmlFor:"cursoId",className:"block text-sm font-medium text-gray-700",children:"Curso"}),s("select",{id:"cursoId",value:o.cursoId,onChange:t=>d({...o,cursoId:t.target.value}),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",required:!0,children:[e("option",{value:"",disabled:!0,children:"Selecione um curso"}),r.cursos.map(t=>e("option",{value:t.id,children:t.nome},t.id))]})]}),s("div",{children:[e("label",{htmlFor:"turmaPeriodo",className:"block text-sm font-medium text-gray-700",children:"Período"}),s("select",{id:"turmaPeriodo",value:o.periodo,onChange:t=>d({...o,periodo:t.target.value}),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",required:!0,children:[e("option",{value:"manha",children:"Manhã"}),e("option",{value:"tarde",children:"Tarde"}),e("option",{value:"noite",children:"Noite"})]})]}),e("div",{className:"pt-2",children:s("div",{className:"flex items-start",children:[e("div",{className:"flex items-center h-5",children:e("input",{id:"isModular",type:"checkbox",checked:o.isModular,onChange:t=>d({...o,isModular:t.target.checked}),className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),s("div",{className:"ml-3 text-sm",children:[e("label",{htmlFor:"isModular",className:"font-medium text-gray-700",children:"Turma Modular?"}),e("p",{className:"text-gray-500",children:"Turmas modulares aparecerão em uma grade de horários separada."})]})]})}),s("div",{className:"mt-4 flex justify-end space-x-2",children:[e("button",{type:"button",onClick:x,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),e("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Salvar"})]})]})}),e(Q,{isOpen:b.isOpen,onClose:()=>D({isOpen:!1,id:null}),onConfirm:C,title:"Confirmar Exclusão de Turma",message:"Tem certeza que deseja excluir esta turma? Todas as disciplinas e aulas associadas também serão removidas permanentemente."})]})},he=({isOpen:r,onClose:i})=>{const{state:g,dispatch:m}=F(),u=v.useMemo(()=>{const n={};return g.disciplinas.forEach(c=>{c.bnccId||(n[c.nome]||(n[c.nome]={turmas:new Set}),n[c.nome].turmas.add(c.turmaId))}),Object.entries(n).filter(([c,b])=>b.turmas.size>1).map(([c,b])=>({nome:c,count:b.turmas.size})).sort((c,b)=>b.count!==c.count?b.count-c.count:c.nome.localeCompare(b.nome))},[g.disciplinas]),l=n=>{m({type:"CREATE_BNCC",payload:{nome:n}})},o=n=>{m({type:"DELETE_BNCC",payload:{bnccId:n}})},d="flex-shrink-0 w-32 justify-center text-center text-sm px-3 py-1 rounded-md transition-colors";return e(V,{isOpen:r,onClose:i,title:"Gerenciar Grupos BNCC",size:"4xl",children:s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s("div",{className:"bg-gray-50 p-4 rounded-lg shadow-inner",children:[e("h3",{className:"text-lg font-semibold mb-3",children:"Sugestões de Grupos BNCC"}),e("p",{className:"text-sm text-gray-500 mb-3",children:"Disciplinas com o mesmo nome em múltiplas turmas são candidatas a se tornarem um grupo BNCC."}),u.length>0?e("ul",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto pr-2",children:u.map(n=>s("li",{className:"py-3 flex justify-between items-center",children:[s("div",{children:[e("span",{className:"font-medium",children:n.nome}),s("span",{className:"text-sm text-gray-500 ml-2",children:["(",n.count," turmas)"]})]}),e("button",{onClick:()=>l(n.nome),className:`${d} bg-green-500 text-white hover:bg-green-600`,children:"Criar Grupo"})]},n.nome))}):e("p",{className:"text-sm text-gray-500",children:"Nenhuma sugestão de grupo BNCC encontrada."})]}),s("div",{className:"bg-gray-50 p-4 rounded-lg shadow-inner",children:[e("h3",{className:"text-lg font-semibold mb-3",children:"Grupos BNCC Atuais"}),e("p",{className:"text-sm text-gray-500 mb-3",children:'As atribuições de professores para estes grupos são feitas na aba "Atribuições".'}),g.bncc.length>0?e("ul",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto pr-2",children:g.bncc.map(n=>s("li",{className:"py-3 flex justify-between items-center",children:[e("span",{className:"font-medium",children:n.nome}),e("button",{onClick:()=>o(n.id),className:`${d} bg-red-500 text-white hover:bg-red-600`,children:"Desfazer Grupo"})]},n.id))}):e("p",{className:"text-sm text-gray-500",children:"Nenhum grupo BNCC foi criado."})]})]})})},pe=()=>{const{state:r,dispatch:i}=F(),[g,m]=v.useState(!1),[u,l]=v.useState(!1),[o,d]=v.useState(null),[n,c]=v.useState({nome:"",turmaId:"",divisao:!1,numProfessores:1,aulasSemanais:1}),[b,D]=v.useState("all"),[N,x]=v.useState({isOpen:!1,id:null});v.useEffect(()=>{!n.turmaId&&r.turmas.length>0&&c(a=>({...a,turmaId:r.turmas[0].id}))},[r.turmas,n.turmaId]);const p=v.useMemo(()=>{var a;return((a=r.turmas.find(A=>A.id===n.turmaId))==null?void 0:a.isModular)??!1},[n.turmaId,r.turmas]),y=a=>{if(d(a),a)c({...a});else{const A=r.turmas.length>0?r.turmas[0].id:"",E=r.turmas.find(O=>O.id===A),L=E!=null&&E.isModular?1.25:1;c({nome:"",turmaId:A,divisao:!1,numProfessores:1,aulasSemanais:L})}m(!0)},C=()=>{m(!1),d(null)},T=a=>{if(a.preventDefault(),!n.nome.trim()||!n.turmaId)return;const A={...n,nome:Y(n.nome),numProfessores:n.divisao?n.numProfessores:1};i(o?{type:"UPDATE_DISCIPLINA",payload:{...o,...A}}:{type:"ADD_DISCIPLINA",payload:{id:`d${Date.now()}`,...A}}),C()},k=a=>{x({isOpen:!0,id:a})},t=()=>{N.id&&i({type:"DELETE_DISCIPLINA",payload:{id:N.id}}),x({isOpen:!1,id:null})},h=a=>{c(A=>{if(o)return{...A,turmaId:a};const E=r.turmas.find(O=>O.id===a),L=E!=null&&E.isModular?1.25:1;return{...A,turmaId:a,aulasSemanais:L}})},f=a=>{var A;return((A=r.turmas.find(E=>E.id===a))==null?void 0:A.nome)||"N/A"},S=v.useMemo(()=>{if(b==="all")return r.disciplinas;const a=r.turmas.filter(A=>A.cursoId===b).map(A=>A.id);return r.disciplinas.filter(A=>a.includes(A.turmaId))},[r.disciplinas,r.turmas,b]);return s("div",{children:[s("div",{className:"flex justify-between items-center mb-4",children:[e("h2",{className:"text-2xl font-bold",children:"Gerenciar Disciplinas"}),s("div",{className:"flex items-center space-x-4",children:[s("div",{className:"w-64",children:[e("label",{htmlFor:"curso-filter",className:"block text-sm font-medium text-gray-700",children:"Filtrar por Curso"}),s("select",{id:"curso-filter",value:b,onChange:a=>D(a.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e("option",{value:"all",children:"Todos os Cursos"}),r.cursos.map(a=>e("option",{value:a.id,children:a.nome},a.id))]})]}),e("button",{onClick:()=>l(!0),className:"self-end px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700",children:"Gerenciar Grupos BNCC"}),e("button",{onClick:()=>y(null),className:"self-end px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400",disabled:r.turmas.length===0,children:"Adicionar Disciplina"})]})]}),e("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:S.length>0?S.map(a=>s("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 flex flex-col justify-between hover:shadow-md transition-shadow",children:[s("div",{children:[e("h4",{className:"font-bold text-gray-800",children:a.nome}),e("p",{className:"text-sm text-gray-500",children:f(a.turmaId)}),s("p",{className:"text-sm text-gray-500",children:[a.aulasSemanais," aulas/semana"]}),s("div",{className:"mt-2 flex flex-wrap gap-2",children:[a.bnccId&&e("span",{className:"text-xs bg-pink-100 text-pink-800 font-semibold px-2 py-0.5 rounded-full",children:"BNCC"}),a.divisao&&s("span",{className:"text-xs bg-blue-100 text-blue-800 font-semibold px-2 py-0.5 rounded-full",children:["Divisão (",a.numProfessores,")"]})]})]}),s("div",{className:"flex justify-end space-x-2 mt-4",children:[e("button",{onClick:()=>y(a),className:"p-2 text-gray-500 hover:text-indigo-600 rounded-full hover:bg-gray-100 transition-colors",title:"Editar",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L14.732 3.732z"})})}),e("button",{onClick:()=>k(a.id),className:"p-2 text-gray-500 hover:text-red-600 rounded-full hover:bg-gray-100 transition-colors",title:"Excluir",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},a.id)):e("div",{className:"col-span-full bg-white border border-gray-200 rounded-lg shadow-sm p-6 text-center text-gray-500",children:r.disciplinas.length===0?"Nenhuma disciplina cadastrada.":"Nenhuma disciplina encontrada para o filtro selecionado."})}),e(V,{isOpen:g,onClose:C,title:o?"Editar Disciplina":"Adicionar Disciplina",children:s("form",{onSubmit:T,className:"space-y-4",children:[s("div",{children:[e("label",{className:"block text-sm font-medium",children:"Nome da Disciplina"}),e("input",{type:"text",value:n.nome,onChange:a=>c({...n,nome:a.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),s("div",{children:[e("label",{className:"block text-sm font-medium",children:"Aulas por Semana"}),e("input",{type:"number",min:p?"1.25":"1",step:p?"1.25":"1",value:n.aulasSemanais,onChange:a=>c({...n,aulasSemanais:parseFloat(a.target.value)||(p?1.25:1)}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),s("div",{children:[e("label",{className:"block text-sm font-medium",children:"Turma"}),e("select",{value:n.turmaId,onChange:a=>h(a.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:r.turmas.map(a=>e("option",{value:a.id,children:a.nome},a.id))})]}),s("div",{className:"flex items-start",children:[e("div",{className:"flex items-center h-5",children:e("input",{id:"divisao",type:"checkbox",checked:n.divisao,onChange:a=>c({...n,divisao:a.target.checked}),className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),e("div",{className:"ml-3 text-sm",children:e("label",{htmlFor:"divisao",className:"font-medium text-gray-700",children:"Divisão de turma?"})})]}),n.divisao&&s("div",{children:[e("label",{className:"block text-sm font-medium",children:"Número de Professores"}),e("input",{type:"number",min:"2",value:n.numProfessores,onChange:a=>c({...n,numProfessores:parseInt(a.target.value)||2}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),s("div",{className:"mt-4 flex justify-end space-x-2",children:[e("button",{type:"button",onClick:C,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),e("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md",children:"Salvar"})]})]})}),e(Q,{isOpen:N.isOpen,onClose:()=>x({isOpen:!1,id:null}),onConfirm:t,title:"Confirmar Exclusão de Disciplina",message:"Tem certeza que deseja excluir esta disciplina? Todas as atribuições e aulas associadas também serão removidas permanentemente."}),e(he,{isOpen:u,onClose:()=>l(!1)})]})},J=r=>{const i={};return r&&typeof r=="object"&&Object.keys(r).forEach(g=>{const m=r[g];Array.isArray(m)?i[g]=m.map(String):typeof m=="string"?i[g]=[m]:i[g]=[]}),i},X=ae.memo(({label:r,horarios:i,disponibilidade:g,onToggleSlot:m,onToggleDay:u,onToggleTime:l})=>s("div",{className:"p-4 border rounded-lg bg-gray-50/50",children:[e("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:r}),s("div",{className:"grid gap-px",style:{gridTemplateColumns:"auto repeat(6, 1fr)"},children:[e("div",{className:"font-semibold text-sm text-gray-500 px-1 py-2 text-center sticky top-0 bg-gray-50",children:"Horário"}),G.map(o=>e("div",{className:"font-semibold text-sm text-gray-500 px-1 py-2 text-center capitalize sticky top-0 bg-gray-50",children:e("button",{type:"button",onClick:()=>u(o,i),className:"hover:text-indigo-600 w-full",title:`Marcar/desmarcar todos os horários da ${r.toLowerCase()} para ${o}`,children:o})},o)),e("div",{className:"font-semibold text-sm text-gray-500 px-1 py-2 text-center sticky top-0 bg-gray-50",children:"Ações"}),i.map(o=>s(ae.Fragment,{children:[e("div",{className:"text-sm font-mono px-1 py-2 text-center flex items-center justify-center bg-white",children:o}),G.map(d=>{var c;const n=((c=g[d])==null?void 0:c.includes(o))??!1;return e("div",{className:"py-1 px-0.5 flex items-center justify-center bg-white",children:e("button",{type:"button",onClick:()=>m(d,o),className:`w-6 h-6 rounded-md transition-colors ${n?"bg-emerald-500 hover:bg-emerald-600":"bg-gray-200 hover:bg-gray-300"}`,"aria-label":`Disponibilidade para ${d} às ${o}: ${n?"Disponível":"Indisponível"}`})},`${d}-${o}`)}),e("div",{className:"py-1 px-0.5 flex items-center justify-center bg-white",children:e("button",{type:"button",onClick:()=>l(o),className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded-full text-xs font-semibold hover:bg-indigo-200 transition-colors",title:`Marcar/desmarcar ${o} para todos os dias`,children:"Todos"})})]},o))]})]})),ge=({disponibilidade:r,onAvailabilityChange:i})=>{const g=(l,o)=>{const d={...r};d[l]||(d[l]=[]);const n=d[l].includes(o);d[l]=n?d[l].filter(c=>c!==o):[...d[l],o],i(d)},m=(l,o)=>{const d={...r};d[l]||(d[l]=[]);const n=o.every(b=>d[l].includes(b));let c=[...d[l]];n?c=c.filter(b=>!o.includes(b)):o.forEach(b=>{c.includes(b)||c.push(b)}),d[l]=c,i(d)},u=l=>{const o={...r},d=G.every(n=>{var c;return(c=o[n])==null?void 0:c.includes(l)});G.forEach(n=>{o[n]||(o[n]=[]);const c=o[n].includes(l);d?c&&(o[n]=o[n].filter(b=>b!==l)):c||o[n].push(l)}),i(o)};return s("div",{className:"space-y-4",children:[e(X,{label:"Manhã",horarios:se,disponibilidade:r,onToggleSlot:g,onToggleDay:m,onToggleTime:u}),e(X,{label:"Tarde",horarios:oe,disponibilidade:r,onToggleSlot:g,onToggleDay:m,onToggleTime:u}),e(X,{label:"Noite",horarios:te,disponibilidade:r,onToggleSlot:g,onToggleDay:m,onToggleTime:u})]})},fe=()=>{const{state:r,dispatch:i}=F(),[g,m]=v.useState(!1),[u,l]=v.useState(new Set),[o,d]=v.useState([]),[n,c]=v.useState({nome:"",disponibilidade:{}}),[b,D]=v.useState(""),[N,x]=v.useState({isOpen:!1,ids:[]}),[p,y]=v.useState(""),C=v.useRef(null),T=v.useRef(0),k=v.useMemo(()=>[...r.professores].sort((w,M)=>w.nome.localeCompare(M.nome)),[r.professores]),t=v.useMemo(()=>p.trim()?k.filter(w=>w.nome.toLowerCase().includes(p.toLowerCase())):k,[k,p]),h=w=>{const M=new Set(u);M.has(w)?M.delete(w):M.add(w),l(M)},f=()=>{u.size===t.length?l(new Set):l(new Set(t.map(w=>w.id)))},S=()=>{d([]),c({nome:"",disponibilidade:{}}),D(""),T.current=0,m(!0)},a=w=>{let M=[];if(w)M=[w];else{if(u.size===0)return;M=k.filter(I=>u.has(I.id))}if(d(M),M.length===1){const I=M[0];c({...I,disponibilidade:J(I.disponibilidade)})}else if(M.length>1){const I={},q=[...se,...oe,...te];G.forEach($=>{I[$]=q.filter(z=>M.every(W=>(Array.isArray(W.disponibilidade[$])?W.disponibilidade[$]:[]).includes(z)))}),c({nome:"",disponibilidade:I})}D(""),T.current=0,m(!0)},A=()=>{m(!1)},E=w=>{w.preventDefault();const M=J(n.disponibilidade),I=Y(n.nome);if(o.length>0)if(o.length===1){if(!I.trim())return;const q={...o[0],nome:I,disponibilidade:M};i({type:"UPDATE_PROFESSOR",payload:q})}else{const q=o.map($=>({...$,disponibilidade:M}));i({type:"BATCH_UPDATE_PROFESSORS",payload:{professors:q}})}else{if(!I.trim())return;i({type:"ADD_PROFESSOR",payload:{id:`p${Date.now()}`,nome:I,disponibilidade:M}})}A(),l(new Set)},L=w=>{x({isOpen:!0,ids:[w]})},O=()=>{u.size!==0&&x({isOpen:!0,ids:Array.from(u)})},B=()=>{N.ids.forEach(w=>{i({type:"DELETE_PROFESSOR",payload:{id:w}})}),x({isOpen:!1,ids:[]}),l(new Set)},P=()=>{if(!b)return;const w=r.professores.find(M=>M.id===b);if(w){const M=J(w.disponibilidade),I=JSON.parse(JSON.stringify(M));c(q=>({...q,disponibilidade:I}))}},R=w=>{C.current&&(T.current=C.current.scrollTop);const M=J(w);c(I=>({...I,disponibilidade:M}))};v.useLayoutEffect(()=>{C.current&&(C.current.scrollTop=T.current)},[n.disponibilidade]);const j=t.length>0&&u.size===t.length,_=o.length===0?"Adicionar Professor":o.length>1?`Editar Disponibilidade de ${o.length} Professores`:"Editar Professor";return s("div",{className:"relative pb-20",children:[s("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[e("h2",{className:"text-2xl font-bold",children:"Gerenciar Professores"}),s("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-2 w-full md:w-auto",children:[e("input",{type:"text",value:p,onChange:w=>y(w.target.value),placeholder:"Buscar por nome...",className:"block w-full sm:w-64 pl-3 pr-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"}),s("button",{onClick:S,className:"w-full sm:w-auto px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 flex items-center justify-center",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Adicionar"]})]})]}),s("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[s("div",{className:"px-4 sm:px-6 py-3 border-b border-gray-200 bg-gray-50 rounded-t-lg flex justify-between items-center",children:[s("div",{className:"flex items-center",children:[e("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer",checked:j,onChange:f,"aria-label":"Selecionar todos os professores"}),e("span",{className:"ml-3 text-sm font-medium text-gray-600",children:"Selecionar Todos"})]}),e("span",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider mr-10",children:"Ações"})]}),e("div",{className:"divide-y divide-gray-200",children:t.length>0?t.map(w=>s("div",{className:"px-4 sm:px-6 py-3 flex items-center justify-between hover:bg-gray-50/50 transition-colors group",children:[s("div",{className:"flex items-center flex-1",children:[e("input",{id:`prof-select-${w.id}`,type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer",checked:u.has(w.id),onChange:()=>h(w.id)}),e("label",{htmlFor:`prof-select-${w.id}`,className:"ml-3 font-medium text-gray-800 cursor-pointer flex-1 select-none",children:w.nome})]}),s("div",{className:"flex items-center space-x-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[e("button",{onClick:()=>a(w),className:"p-2 text-gray-400 hover:text-indigo-600 rounded-full hover:bg-indigo-50 transition-colors",title:"Editar Professor",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L14.732 3.732z"})})}),e("button",{onClick:()=>L(w.id),className:"p-2 text-gray-400 hover:text-red-600 rounded-full hover:bg-red-50 transition-colors",title:"Excluir Professor",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},w.id)):e("div",{className:"px-6 py-8 text-center text-gray-500 bg-gray-50",children:r.professores.length===0?"Nenhum professor cadastrado.":"Nenhum professor encontrado para o filtro selecionado."})})]}),u.size>0&&s("div",{className:"fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-white border border-gray-200 shadow-xl rounded-full px-6 py-3 flex items-center space-x-4 z-40 animate-fade-in-up",children:[s("span",{className:"font-medium text-gray-700 whitespace-nowrap",children:[u.size," selecionado(s)"]}),e("div",{className:"h-5 w-px bg-gray-300"}),s("button",{onClick:()=>a(),className:"flex items-center text-indigo-600 hover:text-indigo-800 font-medium text-sm transition-colors",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L14.732 3.732z"})}),"Editar"]}),s("button",{onClick:O,className:"flex items-center text-red-600 hover:text-red-800 font-medium text-sm transition-colors",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Excluir"]}),e("div",{className:"h-5 w-px bg-gray-300"}),e("button",{onClick:()=>l(new Set),className:"text-gray-400 hover:text-gray-600",title:"Limpar seleção",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e(V,{isOpen:g,onClose:A,title:_,size:"5xl",contentRef:C,children:s("form",{onSubmit:E,className:"space-y-6",children:[o.length<=1&&s("div",{children:[e("label",{className:"block text-sm font-medium",children:"Nome do Professor"}),e("input",{type:"text",value:n.nome,onChange:w=>c({...n,nome:w.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),o.length<=1&&s("div",{children:[e("label",{className:"block text-sm font-medium",children:"Copiar Disponibilidade de:"}),s("div",{className:"mt-1 flex space-x-2",children:[s("select",{value:b,onChange:w=>D(w.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",disabled:r.professores.filter(w=>{var M;return w.id!==(((M=o[0])==null?void 0:M.id)||"")}).length===0,children:[e("option",{value:"",children:"Selecione um professor..."}),r.professores.filter(w=>{var M;return w.id!==(((M=o[0])==null?void 0:M.id)||"")}).sort((w,M)=>w.nome.localeCompare(M.nome)).map(w=>e("option",{value:w.id,children:w.nome},w.id))]}),e("button",{type:"button",onClick:P,disabled:!b,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed",children:"Copiar"})]})]}),s("div",{children:[e("h4",{className:"text-sm font-medium mb-2",children:"Disponibilidade"}),o.length>1&&s("p",{className:"text-xs text-orange-600 bg-orange-50 p-2 rounded-md mb-2",children:[e("strong",{children:"Atenção:"})," Você está editando múltiplos professores. Um horário aparecerá marcado apenas se TODOS os professores selecionados estiverem disponíveis. Qualquer alteração aqui será aplicada a TODOS."]}),e(ge,{disponibilidade:n.disponibilidade,onAvailabilityChange:R})]}),s("div",{className:"mt-6 flex justify-end space-x-2",children:[e("button",{type:"button",onClick:A,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),e("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md",children:"Salvar"})]})]})}),e(Q,{isOpen:N.isOpen,onClose:()=>x({isOpen:!1,ids:[]}),onConfirm:B,title:`Confirmar Exclusão de ${N.ids.length} Professor(es)`,message:`Tem certeza que deseja excluir ${N.ids.length>1?`os ${N.ids.length} professores selecionados`:"este professor"}? Eles serão removidos de todas as atribuições e aulas permanentemente.`}),e("style",{children:`
                @keyframes fade-in-up {
                    0% { opacity: 0; transform: translate(-50%, 10px); }
                    100% { opacity: 1; transform: translate(-50%, 0); }
                }
                .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }
            `})]})},ne=({allProfessors:r,selectedProfessorIds:i,onSelectionChange:g,maxSelection:m=1})=>{const[u,l]=v.useState(""),[o,d]=v.useState(!1),n=v.useRef(null),c=v.useMemo(()=>i.map(p=>r.find(y=>y.id===p)).filter(p=>!!p),[i,r]),b=v.useMemo(()=>{const p=u.toLowerCase();return r.filter(y=>y.nome.toLowerCase().includes(p))},[u,r]);v.useEffect(()=>{const p=y=>{n.current&&!n.current.contains(y.target)&&d(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[n]);const D=p=>{i.length<m&&(g([...i,p]),l(""),d(!1))},N=p=>{g(i.filter((y,C)=>C!==p))},x=i.length<m;return s("div",{className:"relative",ref:n,children:[s("div",{className:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md bg-white min-h-[42px]",children:[c.map((p,y)=>s("div",{className:"flex items-center bg-indigo-100 text-indigo-800 text-sm font-medium px-2 py-1 rounded-full",children:[e("span",{children:p.nome}),e("button",{type:"button",onClick:()=>N(y),className:"ml-2 text-indigo-500 hover:text-indigo-700 focus:outline-none","aria-label":`Remover ${p.nome}`,children:"×"})]},`${p.id}-${y}`)),x&&e("input",{type:"text",value:u,onChange:p=>l(p.target.value),onFocus:()=>d(!0),placeholder:"Adicionar professor...",className:"flex-grow p-1 bg-transparent focus:outline-none"})]}),o&&x&&e("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:b.length>0?b.map(p=>e("li",{onClick:()=>D(p.id),className:"px-4 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100",children:p.nome},p.id)):e("li",{className:"px-4 py-2 text-sm text-gray-500 cursor-default",children:"Nenhum professor encontrado."})})]})},be=()=>{const{state:r,dispatch:i}=F(),{disciplinas:g,professores:m,atribuicoes:u,turmas:l,cursos:o}=r,[d,n]=v.useState(""),c=[...m].sort((C,T)=>C.nome.localeCompare(T.nome)),b=[...o].sort((C,T)=>C.nome.localeCompare(T.nome)),D=C=>{var T;return((T=u.find(k=>k.disciplinaId===C))==null?void 0:T.professores)||[]},N=(C,T)=>{T.length===0?i({type:"DELETE_ATRIBUICAO",payload:{disciplinaId:C}}):i({type:"UPDATE_ATRIBUICAO",payload:{disciplinaId:C,professores:T}})},x=v.useMemo(()=>{if(!d.trim())return null;const C=d.toLowerCase();return c.filter(t=>t.nome.toLowerCase().includes(C)).map(t=>{const h=u.filter(f=>f.professores.includes(t.id)).map(f=>g.find(S=>S.id===f.disciplinaId)).filter(f=>!!f);return{professor:t,disciplinas:h.sort((f,S)=>f.nome.localeCompare(S.nome))}}).filter(t=>t.disciplinas.length>0)},[d,c,u,g]),p=()=>e(ee,{children:b.length>0?b.map(C=>{const T=l.filter(k=>k.cursoId===C.id).sort((k,t)=>k.nome.localeCompare(t.nome));return T.length===0?null:s("div",{className:"bg-white p-4 rounded-lg shadow-md border border-gray-200",children:[e("h3",{className:"text-xl font-bold text-indigo-700 mb-4 pb-2 border-b",children:C.nome}),e("div",{className:"space-y-6",children:T.map(k=>{const t=g.filter(h=>h.turmaId===k.id).sort((h,f)=>h.nome.localeCompare(f.nome));return t.length===0?null:s("div",{children:[s("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[k.nome,k.isModular&&e("span",{className:"text-xs bg-purple-100 text-purple-800 font-semibold ml-2 px-2 py-0.5 rounded-full",children:"Modular"})]}),e("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(h=>s("div",{className:"bg-gray-50 p-3 rounded-lg border",children:[s("div",{className:"mb-2",children:[e("span",{className:"text-sm font-bold text-gray-700",children:h.nome}),h.bnccId&&e("span",{className:"ml-2 text-xs bg-pink-100 text-pink-800 font-semibold px-2 py-0.5 rounded-full",children:"BNCC"}),h.divisao&&s("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 font-semibold px-2 py-0.5 rounded-full",children:["Divisão (",h.numProfessores,")"]})]}),e(ne,{allProfessors:c,selectedProfessorIds:D(h.id),onSelectionChange:f=>N(h.id,f),maxSelection:h.numProfessores})]},h.id))})]},k.id)})})]},C.id)}):e("div",{className:"text-center text-gray-500 py-8 bg-white rounded-lg shadow",children:"Nenhum curso cadastrado. Por favor, adicione cursos na aba 'Cursos'."})}),y=()=>e(ee,{children:x&&x.length>0?x.map(({professor:C,disciplinas:T})=>s("div",{className:"bg-white p-4 rounded-lg shadow-md border border-gray-200",children:[e("h3",{className:"text-xl font-bold text-indigo-700 mb-4 pb-2 border-b",children:C.nome}),e("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(k=>{const t=l.find(f=>f.id===k.turmaId),h=o.find(f=>f.id===(t==null?void 0:t.cursoId));return s("div",{className:"bg-gray-50 p-3 rounded-lg border",children:[s("div",{className:"mb-1",children:[e("span",{className:"text-sm font-bold text-gray-700",children:k.nome}),k.bnccId&&e("span",{className:"ml-2 text-xs bg-pink-100 text-pink-800 font-semibold px-2 py-0.5 rounded-full",children:"BNCC"}),k.divisao&&s("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 font-semibold px-2 py-0.5 rounded-full",children:["Divisão (",k.numProfessores,")"]})]}),s("div",{className:"text-xs text-gray-500 mb-2",children:[h==null?void 0:h.nome," / ",t==null?void 0:t.nome]}),e(ne,{allProfessors:c,selectedProfessorIds:D(k.id),onSelectionChange:f=>N(k.id,f),maxSelection:k.numProfessores})]},k.id)})})]},C.id)):s("div",{className:"text-center text-gray-500 py-8 bg-white rounded-lg shadow",children:['Nenhum professor encontrado com o nome "',d,'" que possua atribuições.']})});return s("div",{children:[s("div",{className:"flex justify-between items-center mb-4",children:[e("h2",{className:"text-2xl font-bold",children:"Gerenciar Atribuições"}),s("div",{className:"w-64",children:[e("label",{htmlFor:"professor-search-atribuicao",className:"block text-sm font-medium text-gray-700",children:"Buscar por Professor"}),e("input",{type:"text",id:"professor-search-atribuicao",value:d,onChange:C=>n(C.target.value),placeholder:"Digite o nome...",className:"mt-1 block w-full pl-3 pr-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"})]})]}),e("div",{className:"space-y-8",children:d.trim()?y():p()})]})},re=r=>r.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),xe=r=>{const i=re(r);return i.includes("manha")?"manha":i.includes("tarde")?"tarde":i.includes("noite")?"noite":"manha"},K=(r,i)=>{const g=re(r);let m=0;for(let l=0;l<g.length;l++){const o=g.charCodeAt(l);m=(m<<5)-m+o,m|=0}const u=g.replace(/[^a-z0-9]/g,"");return`${i}-${u.substring(0,30)}-${Math.abs(m).toString(36)}`},ye=r=>{try{const g=new DOMParser().parseFromString(r,"text/html"),m=new Map,u=new Map,l=new Map,o=new Map,d=[],n=["ensino medio","mtec","novotec","integrado"],c=N=>{const x=N?N.trim():"Desconhecido",p={};if(["segunda","terca","quarta","quinta","sexta","sabado","domingo"].forEach(C=>p[C]=[]),!x||x==="Vago")return o.has("Vago")||o.set("Vago",{id:"p-vago",nome:"Vago",disponibilidade:p}),o.get("Vago");const y=K(x,"p");if(!o.has(x)){const C={id:y,nome:x,disponibilidade:p};o.set(x,C)}return o.get(x)},b=g.querySelectorAll("tr.success");if(!b||b.length===0)throw new Error("Não foi possível identificar as turmas no arquivo. Verifique se a estrutura HTML corresponde à página 'Consultar Quadros'.");b.forEach(N=>{var B;const x=Array.from(N.querySelectorAll("strong")),p=Array.from(N.querySelectorAll("b")),y=(P,R)=>{var j,_,w;for(const M of R)if(M&&((_=(j=M.previousSibling)==null?void 0:j.textContent)!=null&&_.includes(P)))return((w=M.textContent)==null?void 0:w.trim())||null;return null},C=y("Curso:",p)||"Curso Desconhecido",T=re(C),k=!n.some(P=>T.includes(P)),t=C.replace(/\s*\(.*?\)\s*/g," ").trim(),h=y("Turma:",x),f=y("Período:",x);if(!h||!f)return;m.has(t)||m.set(t,{id:K(t,"c"),nome:t});const S=m.get(t),a=`${S.nome}-${h}`;u.has(a)||u.set(a,{id:K(a,"t"),cursoId:S.id,nome:h,periodo:xe(f),isModular:k});const A=u.get(a),E=(B=N.nextElementSibling)==null?void 0:B.querySelector("table.table-condensed");if(!E)return;const L=Array.from(E.querySelectorAll("tbody > tr:not(.warning)")),O=new Map;L.forEach(P=>{const R=P.querySelectorAll("td");if(R.length<7)return;const j=R[0].querySelector("a"),M=(j?j.textContent||"":R[0].textContent||"").replace(/^\(\d+\)_/,"").trim().replace(/\s*\(.*?\)\s*/g," ").trim();if(!M)return;const I=parseFloat((R[4].textContent||"0").replace(",",".")),q=k?I:Math.round(I);O.has(M)||O.set(M,{rows:[],aulasSemanais:q}),O.get(M).rows.push(P)}),O.forEach((P,R)=>{const{rows:j,aulasSemanais:_}=P;if(j.length===0)return;const w=j.length>1,M=[];j.forEach($=>{const z=$.querySelectorAll("td"),W=z.length>6?(z[6].textContent||"").trim():"Vago";M.push(c(W).id)});const I=`${A.id}-${R}`;if(!l.has(I)){const $={id:K(I,"d"),turmaId:A.id,nome:R,aulasSemanais:_,divisao:w,numProfessores:j.length};l.set(I,$)}const q=l.get(I);M.length>0&&(d.find(z=>z.disciplinaId===q.id)||d.push({disciplinaId:q.id,professores:M.filter(z=>z!=="p-vago")}))})});const D=Array.from(o.values());return{ano:new Date().getFullYear(),cursos:Array.from(m.values()),turmas:Array.from(u.values()),disciplinas:Array.from(l.values()),professores:D,atribuicoes:d,grade:[],alertas:[]}}catch(i){throw console.error("Error parsing HTML:",i),new Error(`Erro ao processar o arquivo: ${i.message}`)}},ve=()=>{var k,t,h,f;const{dispatch:r}=F(),[i,g]=v.useState("upload"),[m,u]=v.useState(null),[l,o]=v.useState(null),[d,n]=v.useState({}),[c,b]=v.useState(!1),[D,N]=v.useState(null),x=S=>{var A;const a=(A=S.target.files)==null?void 0:A[0];a&&(u(a),N(null))},p=()=>{if(!m){N("Por favor, selecione um arquivo HTML.");return}b(!0),N(null);const S=new FileReader;S.onload=a=>{var A;try{const E=(A=a.target)==null?void 0:A.result,L=ye(E);if(!L.turmas||L.turmas.length===0)throw new Error("Nenhuma turma encontrada. Verifique se o arquivo HTML contém as tabelas de horário.");if(o(L),L.turmas){const O={};L.turmas.forEach(B=>{O[B.id]=B.isModular}),n(O)}g("validate")}catch(E){N(E.message||"Ocorreu um erro desconhecido ao analisar o arquivo."),console.error(E)}finally{b(!1)}},S.onerror=()=>{N("Não foi possível ler o arquivo. Verifique se ele não está corrompido."),b(!1)},S.readAsText(m,"UTF-8")},y=()=>{var S;if(l){const a=((S=l.turmas)==null?void 0:S.map(E=>({...E,isModular:d[E.id]??E.isModular})))??[],A={version:"1.0",ano:l.ano??new Date().getFullYear(),cursos:l.cursos??[],turmas:a,disciplinas:l.disciplinas??[],professores:l.professores??[],atribuicoes:l.atribuicoes??[],grade:[],alertas:[],bncc:[],lastModifiedBy:null,lastModifiedAt:null};r({type:"SET_STATE",payload:A}),g("success")}},C=()=>{u(null),o(null),N(null),b(!1),g("upload")},T=(S,a)=>{n(A=>({...A,[S]:a}))};return s("div",{className:"max-w-4xl mx-auto",children:[e("h2",{className:"text-2xl font-bold mb-4",children:"Importar Dados de HTML (SIG)"}),i==="upload"&&s("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e("h3",{className:"text-lg font-semibold",children:"Passo 1: Selecionar Arquivo"}),e("p",{className:"text-sm text-gray-600",children:'Selecione o arquivo HTML salvo a partir da página "Consultar Quadros" do sistema SIG-URH. O sistema irá extrair os cursos, turmas, disciplinas e professores.'}),s("div",{children:[e("label",{htmlFor:"html-upload-label",className:"block text-sm font-medium text-gray-700 mb-1",children:"Arquivo HTML"}),s("div",{className:"mt-1 flex items-center space-x-3",children:[e("label",{htmlFor:"html-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Escolher arquivo"}),e("input",{id:"html-upload",name:"html-upload",type:"file",accept:".html,.htm",onChange:x,className:"sr-only"}),m?e("span",{className:"text-sm text-gray-600",children:m.name}):e("span",{className:"text-sm text-gray-500",children:"Nenhum arquivo selecionado"})]})]}),D&&e("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:s("div",{className:"flex",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e("div",{className:"ml-3",children:e("p",{className:"text-sm text-red-700",children:D})})]})}),e("div",{className:"flex justify-end",children:e("button",{onClick:p,disabled:!m||c,className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:c?s(ee,{children:[e(de,{size:20,color:"text-white mr-2"}),"Analisando..."]}):"Analisar Arquivo"})})]}),i==="validate"&&l&&s("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e("h3",{className:"text-lg font-semibold",children:"Passo 2: Validar Dados"}),s("p",{className:"text-sm text-gray-600",children:["Os seguintes dados foram encontrados. ",e("strong",{children:"Atenção:"})," A importação substituirá todos os dados existentes."]}),s("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[s("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e("div",{className:"text-2xl font-bold",children:((k=l.cursos)==null?void 0:k.length)||0}),e("div",{className:"text-sm",children:"Cursos"})]}),s("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e("div",{className:"text-2xl font-bold",children:((t=l.turmas)==null?void 0:t.length)||0}),e("div",{className:"text-sm",children:"Turmas"})]}),s("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e("div",{className:"text-2xl font-bold",children:((h=l.disciplinas)==null?void 0:h.length)||0}),e("div",{className:"text-sm",children:"Disciplinas"})]}),s("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e("div",{className:"text-2xl font-bold",children:((f=l.professores)==null?void 0:f.length)||0}),e("div",{className:"text-sm",children:"Professores"})]})]}),s("div",{className:"mt-4 border-t pt-4",children:[e("h4",{className:"font-semibold",children:"Validar Classificação das Turmas"}),e("p",{className:"text-sm text-gray-600 mb-2",children:"Verifique a lista de turmas importadas. Marque a caixa ao lado de cada turma que deve ser considerada 'Modular'. Turmas não marcadas serão tratadas como 'Regular' (Ensino Médio, MTec, etc.)."}),e("div",{className:"max-h-64 overflow-y-auto space-y-1 border p-3 rounded-md bg-gray-50",children:l.turmas&&l.turmas.length>0?l.turmas.slice().sort((S,a)=>S.nome.localeCompare(a.nome)).map(S=>s("div",{className:"flex items-center p-1 hover:bg-gray-100 rounded",children:[e("input",{type:"checkbox",id:`turma-modular-toggle-${S.id}`,checked:d[S.id]??!1,onChange:a=>T(S.id,a.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e("label",{htmlFor:`turma-modular-toggle-${S.id}`,className:"ml-3 block text-sm font-medium text-gray-700 cursor-pointer select-none",children:S.nome})]},S.id)):e("p",{className:"text-sm text-gray-500",children:"Nenhuma turma encontrada no arquivo."})})]}),s("div",{className:"flex justify-end space-x-2",children:[e("button",{onClick:C,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),e("button",{onClick:y,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Confirmar e Importar"})]})]}),i==="success"&&s("div",{className:"bg-white p-6 rounded-lg shadow text-center space-y-4",children:[e("div",{className:"flex justify-center",children:e("svg",{className:"h-16 w-16 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e("h3",{className:"text-lg font-semibold text-green-700",children:"Importação Concluída!"}),e("p",{children:"Os dados foram importados com sucesso. Você já pode navegar para as outras abas de gerenciamento para ver os resultados."}),e("button",{onClick:C,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Importar Novo Arquivo"})]})]})},Z={"2ª":"segunda","3ª":"terca","4ª":"quarta","5ª":"quinta","6ª":"sexta"},U={MANHA:{horarios:se,title:"Dias da Semana Manhã"},TARDE:{horarios:oe,title:"Dias da Semana Tarde"},NOITE:{horarios:te,title:"Dias da Semana Noite"}},H=r=>{if(r.value===null||r.value===void 0)return"";if(r.value&&typeof r.value=="object"&&"richText"in r.value){const i=r.value;if(Array.isArray(i.richText))return i.richText.map(g=>g.text).join("")}return r.value.toString()},Ne=async r=>{console.log("Iniciando análise da planilha...");const i=new ie.Workbook;await i.xlsx.load(r);const g=i.worksheets[0];if(!g)throw new Error("A planilha está vazia ou não pôde ser lida.");const m=[],u=[];if(g.eachRow((l,o)=>{let d="";l.eachCell(n=>{const c=H(n).trim();c.toLowerCase().startsWith("docente:")&&(d=c.substring(8).trim())}),d&&(console.log(`Encontrado "Docente:": ${d} na linha ${o}`),u.push({name:d,row:o}))}),u.length===0)throw new Error("Nenhum professor encontrado. Verifique se a planilha contém a linha 'Docente:'.");for(const l of u){const o={segunda:[],terca:[],quarta:[],quinta:[],sexta:[]};let d=-1;for(let N=l.row;N<=g.rowCount&&N<l.row+10;N++){const x=g.getRow(N);let p=!1;if(x.eachCell(y=>{H(y).includes(U.MANHA.title)&&(p=!0)}),p){d=N,console.log(`Cabeçalho da tabela encontrado para ${l.name} na linha ${d}`);break}}if(d===-1){console.warn(`Tabelas não encontradas para o professor: ${l.name}`);continue}const n=g.getRow(d),c=g.getRow(d+1),b={};n.eachCell((N,x)=>{const p=H(N);p.includes(U.MANHA.title)&&(b.MANHA=x),p.includes(U.TARDE.title)&&(b.TARDE=x),p.includes(U.NOITE.title)&&(b.NOITE=x)});for(const N of Object.keys(b)){const x=b[N],{horarios:p}=U[N],y={},C=8;for(let h=0;h<C;h++){const f=x+h,S=c.getCell(f),a=H(S).trim();Z[a]&&(y[Z[a]]=f)}const T=Object.keys(Z).length;Object.keys(y).length<T&&console.warn(`Apenas ${Object.keys(y).length} de ${T} dias foram mapeados para ${l.name} [${N}]`),console.log(`Mapeamento de colunas para ${l.name} [${N}]:`,y);const k=x-1,t=6;console.log(`
=== Processando período ${N} para ${l.name} ===`),console.log(`Coluna inicial (dias): ${x}, Coluna 'Aulas': ${k}`),console.log(`Linha do cabeçalho dos dias: ${c.number}`),console.log("Horários disponíveis no período:",p);for(let h=0;h<t;h++){const f=g.getRow(c.number+1+h),S=f.getCell(k),A=H(S).trim().match(/^(\d+)/);if(A){const E=parseInt(A[1],10)-1;if(E>=0&&E<p.length){const L=p[E];for(const O in y){const B=y[O],P=f.getCell(B);H(P).trim().toLowerCase()==="x"&&(o[O].includes(L)||o[O].push(L))}}}}}const D=Object.values(o).reduce((N,x)=>N+x.length,0);console.log(`Disponibilidades encontradas para ${l.name}: ${D} horários.`),m.push({name:l.name,availability:o})}return console.log("Análise finalizada.",m),m},we=async()=>{const r=new ie.Workbook,i=r.addWorksheet("Disponibilidade"),g={name:"Calibri",size:11,bold:!0},m={name:"Calibri",size:14,bold:!0},u={vertical:"middle",horizontal:"center"},l={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},o={manha:{start:2,title:"Dias da Semana Manhã"},tarde:{start:10,title:"Dias da Semana Tarde"},noite:{start:18,title:"Dias da Semana Noite"}},d=7,n=o.noite.start+d-1;i.mergeCells(3,2,3,n);const c=i.getCell(3,2);c.value="RELATÓRIO DE DISPONIBILIDADES DOS DOCENTES",c.font=m,c.alignment=u,i.mergeCells(4,2,4,n),i.getCell(4,2).value="Semestre/ano: 1/2025",i.getCell(4,2).font=g;let D=(x=>{i.mergeCells(x,2,x,n);const p=i.getCell(x,2);p.value={richText:[{text:"Docente: ",font:{name:"Calibri",size:12,bold:!0}},{text:"NOME COMPLETO DO DOCENTE EM MAIÚSCULAS",font:{name:"Calibri",size:12,bold:!0}}]};const y=x+2,C=x+3,T=x+4;return Object.values(o).forEach(k=>{i.mergeCells(y,k.start,y,k.start+d-1);const t=i.getCell(y,k.start);t.value=k.title,t.font=g,t.alignment=u,["Aulas","2ª","3ª","4ª","5ª","6ª","Sáb"].forEach((f,S)=>{const a=i.getCell(C,k.start+S);a.value=f,a.font=g,a.alignment=u,a.border=l});for(let f=0;f<6;f++){const S=T+f,a=i.getCell(S,k.start);a.value=`${f+1}ª`,a.font=g,a.alignment=u,a.border=l;for(let A=1;A<d;A++){const E=i.getCell(S,k.start+A);E.border=l,E.alignment=u,k.start===o.manha.start&&f<2&&A<3&&(E.value="X")}}}),T+6})(5);i.mergeCells(D+1,2,D+1,n);const N=i.getCell(D+1,2);return N.value="Para adicionar mais professores, copie o bloco acima (linhas 5 a 15) e cole abaixo, depois preencha os dados.",N.font={italic:!0,color:{argb:"FF666666"}},i.getColumn(1).width=2,i.getColumn(9).width=2,i.getColumn(17).width=2,Object.values(o).forEach(x=>{i.getColumn(x.start).width=8;for(let p=1;p<d;p++)i.getColumn(x.start+p).width=5}),r},le=r=>r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),Ce=()=>{const{state:r,dispatch:i}=F(),[g,m]=v.useState("upload"),[u,l]=v.useState(null),[o,d]=v.useState([]),[n,c]=v.useState(!1),[b,D]=v.useState(null),N=t=>{var f;const h=(f=t.target.files)==null?void 0:f[0];h&&(l(h),D(null))},x=async()=>{try{const h=await(await we()).xlsx.writeBuffer(),f=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),S=URL.createObjectURL(f),a=document.createElement("a");a.href=S,a.download="modelo_disponibilidade.xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(S)}catch(t){console.error("Error generating template:",t),D("Não foi possível gerar o modelo de planilha.")}},p=()=>{if(!u){D("Por favor, selecione um arquivo Excel.");return}c(!0),D(null);const t=new FileReader;t.onload=async h=>{var f;try{const S=(f=h.target)==null?void 0:f.result,a=await Ne(S);if(a.length===0)throw new Error("Nenhum professor encontrado na planilha. Verifique se o formato está correto ou use o modelo.");const A=r.professores,E=a.map(L=>{const O=A.find(B=>le(B.nome)===le(L.name));return{parsed:L,matchId:O?O.id:"not_found"}});d(E),m("validate")}catch(S){D(S.message||"Ocorreu um erro ao analisar a planilha. Verifique se o formato está correto."),console.error(S)}finally{c(!1)}},t.onerror=()=>{D("Não foi possível ler o arquivo."),c(!1)},t.readAsArrayBuffer(u)},y=(t,h)=>{const f=[...o];f[t].matchId=h,d(f)},C=()=>{const t=[];o.forEach(h=>{if(h.matchId!=="not_found"&&h.matchId!=="ignore"){const f=r.professores.find(S=>S.id===h.matchId);f&&t.push({...f,disponibilidade:h.parsed.availability})}}),t.length>0?(i({type:"BATCH_UPDATE_PROFESSORS",payload:{professors:t}}),m("success")):D("Nenhum professor foi selecionado para atualização. Verifique os pareamentos.")},T=()=>{l(null),d([]),D(null),c(!1),m("upload")},k=v.useMemo(()=>[...r.professores].sort((t,h)=>t.nome.localeCompare(h.nome)),[r.professores]);return s("div",{className:"max-w-4xl mx-auto",children:[e("h2",{className:"text-2xl font-bold mb-4",children:"Importar Disponibilidade de Professores (Excel)"}),g==="upload"&&s("div",{className:"bg-white p-6 rounded-lg shadow space-y-6",children:[s("div",{children:[e("h3",{className:"text-lg font-semibold",children:"Instruções"}),s("ol",{className:"list-decimal list-inside text-sm text-gray-600 mt-2 space-y-1",children:[e("li",{children:"Baixe o modelo de planilha para garantir o formato correto."}),e("li",{children:"Preencha a planilha com os dados de disponibilidade dos professores, marcando 'X' nos horários disponíveis."}),e("li",{children:"Salve a planilha e selecione o arquivo abaixo."}),e("li",{children:'Clique em "Analisar Planilha" para continuar.'})]})]}),e("div",{className:"flex justify-start",children:s("button",{onClick:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Baixar Modelo de Planilha"]})}),s("div",{children:[e("label",{htmlFor:"excel-upload-label",className:"block text-sm font-medium text-gray-700 mb-1",children:"Arquivo Excel (.xlsx)"}),s("div",{className:"mt-1 flex items-center space-x-3",children:[e("label",{htmlFor:"excel-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Escolher arquivo"}),e("input",{id:"excel-upload",name:"excel-upload",type:"file",accept:".xlsx",onChange:N,className:"sr-only"}),u?e("span",{className:"text-sm text-gray-600",children:u.name}):e("span",{className:"text-sm text-gray-500",children:"Nenhum arquivo selecionado"})]})]}),b&&e("p",{className:"text-sm text-red-600",children:b}),e("div",{className:"flex justify-end",children:e("button",{onClick:p,disabled:!u||n,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-400",children:n?"Analisando...":"Analisar Planilha"})})]}),g==="validate"&&o.length>0&&s("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e("h3",{className:"text-lg font-semibold",children:"Passo 2: Validar Pareamento"}),e("p",{className:"text-sm text-gray-600",children:"O sistema tentou parear os professores da planilha com os do sistema. Por favor, revise e ajuste os pareamentos. A disponibilidade dos professores selecionados será **substituída**."}),b&&e("p",{className:"text-sm text-red-600",children:b}),e("div",{className:"overflow-x-auto border rounded-lg",children:s("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:s("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome na Planilha"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Professor no Sistema"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((t,h)=>s("tr",{className:t.matchId==="not_found"?"bg-yellow-50":t.matchId==="ignore"?"bg-gray-100 opacity-60":"",children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.parsed.name}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:s("select",{value:t.matchId,onChange:f=>y(h,f.target.value),className:"w-full p-2 border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[t.matchId==="not_found"&&e("option",{value:"not_found",children:"-- Nenhum professor encontrado --"}),e("option",{value:"ignore",children:"Ignorar este professor"}),k.map(f=>e("option",{value:f.id,children:f.nome},f.id))]})})]},h))})]})}),s("div",{className:"flex justify-end space-x-2",children:[e("button",{onClick:T,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),e("button",{onClick:C,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Confirmar e Atualizar"})]})]}),g==="success"&&s("div",{className:"bg-white p-6 rounded-lg shadow text-center space-y-4",children:[e("h3",{className:"text-lg font-semibold text-green-700",children:"Importação Concluída!"}),e("p",{children:'A disponibilidade dos professores selecionados foi atualizada com sucesso. Você pode verificar as mudanças na aba "Professores".'}),e("button",{onClick:T,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Importar Nova Planilha"})]})]})},Oe=()=>{const[r,i]=v.useState("cursos"),g=()=>{switch(r){case"cursos":return e(me,{});case"turmas":return e(ue,{});case"disciplinas":return e(pe,{});case"professores":return e(fe,{});case"atribuicoes":return e(be,{});case"importar-html":return e(ve,{});case"importar-disp-excel":return e(Ce,{});default:return null}},m=({tabName:u,label:l,disabled:o})=>e("button",{onClick:()=>i(u),disabled:o,title:o?"Função em desenvolvimento":"",className:`px-4 py-2 text-sm font-medium border-b-2 ${r===u?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} disabled:opacity-50 disabled:cursor-not-allowed disabled:text-gray-400 disabled:hover:border-transparent`,children:l});return s("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[e("div",{className:"border-b border-gray-200",children:s("nav",{className:"-mb-px flex space-x-4 px-4 overflow-x-auto","aria-label":"Tabs",children:[e(m,{tabName:"cursos",label:"Cursos"}),e(m,{tabName:"turmas",label:"Turmas"}),e(m,{tabName:"disciplinas",label:"Disciplinas"}),e(m,{tabName:"professores",label:"Professores"}),e(m,{tabName:"atribuicoes",label:"Atribuições"}),e(m,{tabName:"importar-html",label:"Importar SIG (HTML)"}),e(m,{tabName:"importar-disp-excel",label:"Importar Disp. (Excel)",disabled:!0})]})}),e("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:g()})]})};export{Oe as default};
